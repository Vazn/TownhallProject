var e=this&&this.__awaiter||function(e,t,n,o){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,c){function i(e){try{u(o.next(e))}catch(e){c(e)}}function l(e){try{u(o.throw(e))}catch(e){c(e)}}function u(e){e.done?n(e.value):r(e.value).then(i,l)}u((o=o.apply(e,t||[])).next())}))};import{queryControler as t}from"./fetchModule.js";import n from"../node_modules/animejs/lib/anime.es.js";export function articleHandler(){let e;e=""===window.location.pathname.slice(1)?"actualites":window.location.pathname.slice(1),r(),l(e)}function o(){const e=document.querySelectorAll(".card h3"),t=document.querySelectorAll(".card .picture"),n=document.querySelectorAll(".card pre"),o=document.querySelector(".modal"),r=document.querySelector(".modalContent");for(let c=0;c<e.length;c++)e[c].addEventListener("click",(()=>{r.innerHTML="";const[e,i]=[t[c].getAttribute("src"),n[c].textContent],l=document.createElement("hr");l.setAttribute("class","littleHr"),l.style.margin="4% 0 3% 0";const u=document.createElement("img");u.setAttribute("src",e);const a=document.createElement("p");a.textContent=i,r.append(u),r.append(l),r.append(a),o.style.visibility="visible",o.style.opacity="100"}));window.addEventListener("mousedown",(e=>{e.target===o&&(o.style.opacity="0",o.style.visibility="hidden")}))}function r(){const e=document.querySelectorAll(".gear"),t=document.querySelectorAll(".trash");for(let n=0;n<e.length;n++){const o=document.querySelectorAll("article h3")[n].textContent,r=document.querySelectorAll("article pre")[n].textContent;e[n].addEventListener("click",c(o,r,n)),t[n].addEventListener("click",i(o,n))}}function c(e,t,n){const o=document.querySelector("#adminSection input[name=title]"),r=document.querySelector("#adminSection textarea");return n=>{n.preventDefault(),o.setAttribute("value",e),r.textContent=t,window.scroll(0,5e3)}}function i(o,r){return c=>e(this,void 0,void 0,(function*(){c.preventDefault();const e=document.querySelectorAll("article"),i=yield t(["deleteArticle/",o],{method:"GET"});let l=800,u=n.timeline({easing:"easeOutQuad",duration:l,targets:e[r]});i.success?(u.add({opacity:0}),setTimeout((()=>{e[r].style.display="none"}),l+100)):alert("Un problême est survenu sur le serveur, suppression impossible !")}))}function l(t){var n;const o=null!==(n=document.querySelector("#adminSection form"))&&void 0!==n?n:null,r=document.querySelector("#articleCreationFeedback");null!==o&&o.addEventListener("submit",(n=>e(this,void 0,void 0,(function*(){n.preventDefault();const e=yield u(o,t),c=e.type;e.success?(r.style.color="var(--green)",r.textContent="",r.textContent=`${c} réussie !`):(r.style.color="var(--red)",r.textContent="",r.textContent="Impossible de contacter le serveur ou la base de donnée !")}))))}function u(n,o){return e(this,void 0,void 0,(function*(){const e=new FormData(n);return yield t([`articleUpdate/${o}`],{method:"POST",body:e})}))}export{r as buttonsHandler,l as articleForm,o as articleModals};